function cctOut = cctItmo(Lambda, I)

c = 3e8;
h = 6.6262e-34;
k = 1.38067e-23;
LL = Lambda*1e-9;
plank = 2*h*c^2./(LL.^5.*(exp(h*c./(LL*k*6000))-1));

xyuvOut = itmo.xyuvItmo(Lambda, I);
X = xyuvOut.X;
Y = xyuvOut.Y;
Z = xyuvOut.Z;

% Цветовая температура c T в миредах (mu), 
% координаты цветности излучателя Планка на цветовой диаграмме 1976 г. (ux0 , vx0) 
% и тангенсы наклонов изотермических линий (t)
Tc = [0	10	20	30	40	50	60	70	80	90	100	125	150	175	200	225	250	275	300	325	350	375	400	425	450	475	500	525	550	575	600];
ux0 = [0.180060000000000	0.180660000000000	0.181330000000000	0.182080000000000	0.182930000000000	0.183880000000000	0.184940000000000	0.186110000000000	0.187400000000000	0.188800000000000	0.190320000000000	0.194620000000000	0.199620000000000	0.205250000000000	0.211420000000000	0.218070000000000	0.225110000000000	0.232470000000000	0.240100000000000	0.247920000000000	0.255910000000000	0.264000000000000	0.272180000000000	0.280390000000000	0.288630000000000	0.296850000000000	0.305050000000000	0.313200000000000	0.321290000000000	0.329310000000000	0.337240000000000];
vx0 = [0.263520000000000	0.265890000000000	0.268460000000000	0.271190000000000	0.274070000000000	0.277090000000000	0.280210000000000	0.283420000000000	0.286680000000000	0.289970000000000	0.293260000000000	0.301410000000000	0.309210000000000	0.316470000000000	0.323120000000000	0.329090000000000	0.334390000000000	0.339040000000000	0.343080000000000	0.346550000000000	0.349510000000000	0.352000000000000	0.354070000000000	0.355770000000000	0.357140000000000	0.358230000000000	0.359070000000000	0.359680000000000	0.360110000000000	0.360380000000000	0.360510000000000];
t = [-0.243410000000000	-0.254790000000000	-0.268760000000000	-0.285390000000000	-0.304700000000000	-0.326750000000000	-0.351560000000000	-0.379150000000000	-0.409550000000000	-0.442780000000000	-0.478880000000000	-0.582040000000000	-0.704710000000000	-0.849010000000000	-1.01820000000000	-1.21680000000000	-1.45120000000000	-1.72980000000000	-2.06370000000000	-2.46810000000000	-2.96410000000000	-3.58140000000000	-4.36330000000000	-5.37620000000000	-6.72620000000000	-8.59550000000000	-11.3240000000000	-15.6280000000000	-23.3250000000000	-40.7700000000000	-116.450000000000];

ux = 4*X/(X+15*Y+3*Z); % u в специализированном цветовом простраснтве u' с точкой
vx = 6*Y/(X+15*Y+3*Z); % v в специализированном цветовом простраснтве v' с точкой

d = ((vx-vx0) - t.*(ux-ux0))./sqrt(1+t.^2);
pos_val = find(d > 0);
[d1, d1_idx] = min(d(pos_val));
d2_idx = d1_idx + 1;
d2 = d(d2_idx);
Tc1 = Tc(d1_idx);
Tc2 = Tc(d2_idx);
Txc = Tc1 + d1 * (Tc2-Tc1)/(d1-d2); %Тц в миредах (u)
TxcK = 1e6/Txc; % Тц в К

cctOut.CCT = TxcK;

end

